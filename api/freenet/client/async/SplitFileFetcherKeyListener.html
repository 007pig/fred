<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_0) on Thu Jan 14 17:34:10 GMT 2010 -->
<TITLE>
SplitFileFetcherKeyListener
</TITLE>

<META NAME="date" CONTENT="2010-01-14">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="SplitFileFetcherKeyListener";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../freenet/client/async/SplitFileFetcher.html" title="class in freenet.client.async"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../freenet/client/async/SplitFileFetcherSegment.html" title="class in freenet.client.async"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?freenet/client/async/SplitFileFetcherKeyListener.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SplitFileFetcherKeyListener.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
freenet.client.async</FONT>
<BR>
Class SplitFileFetcherKeyListener</H2>
<PRE>
<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>freenet.client.async.SplitFileFetcherKeyListener</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../freenet/client/async/KeyListener.html" title="interface in freenet.client.async">KeyListener</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>SplitFileFetcherKeyListener</B><DT>extends <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A><DT>implements <A HREF="../../../freenet/client/async/KeyListener.html" title="interface in freenet.client.async">KeyListener</A></DL>
</PRE>

<P>
KeyListener implementation for SplitFileFetcher.
 Details:
 - We have a bloom filter. This is kept in RAM, but stored in a file. It is a
 counting filter which is created with the splitfile; when a block is 
 completed, it is removed from the filter, and we schedule a write after a
 certain period of time (we ensure that the write doesn't happen before that).
 Hence even on a fast node, we won't have to write the filter so frequently
 as to be a problem. We could use mmap'ed filters, but that might also be a
 problem with fd's.
 - When a block is actually found, on the database thread, we load the per-
 segment bloom filters from the SplitFileFetcher, and thus determine which 
 segment it belongs to. These are non-counting and static.
<P>

<P>
<DL>
<DT><B>Author:</B></DT>
  <DD>Matthew Toseland <toad@amphibian.dyndns.org> (0xE43DA450)
 
 LOCKING: Synchronize when changing something, and writing to disk. 
 Don't need to synchronize on read in most cases, at least for sane 
 BloomFilter implementations (that is, counting with counting width less than
 and divisible into 8).</DD>
</DL>
<HR>

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#SplitFileFetcherKeyListener(freenet.client.async.SplitFileFetcher, int, java.io.File, java.io.File, int, int, byte[], int, int, int, boolean, boolean)">SplitFileFetcherKeyListener</A></B>(<A HREF="../../../freenet/client/async/SplitFileFetcher.html" title="class in freenet.client.async">SplitFileFetcher</A>&nbsp;parent,
                            int&nbsp;keyCount,
                            <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</A>&nbsp;bloomFile,
                            <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</A>&nbsp;altBloomFile,
                            int&nbsp;mainBloomSizeBytes,
                            int&nbsp;mainBloomK,
                            byte[]&nbsp;localSalt,
                            int&nbsp;segments,
                            int&nbsp;segmentFilterSizeBytes,
                            int&nbsp;segmentBloomK,
                            boolean&nbsp;persistent,
                            boolean&nbsp;newFilter)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Caller must create bloomFile, but it may be empty.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#countKeys()">countKeys</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;short</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#definitelyWantKey(freenet.keys.Key, byte[], com.db4o.ObjectContainer, freenet.client.async.ClientContext)">definitelyWantKey</A></B>(<A HREF="../../../freenet/keys/Key.html" title="class in freenet.keys">Key</A>&nbsp;key,
                  byte[]&nbsp;saltedKey,
                  com.db4o.ObjectContainer&nbsp;container,
                  <A HREF="../../../freenet/client/async/ClientContext.html" title="class in freenet.client.async">ClientContext</A>&nbsp;context)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Do we want the key? This is called by the ULPR code, because fetching the
 key will involve significant work.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../freenet/client/async/HasKeyListener.html" title="interface in freenet.client.async">HasKeyListener</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#getHasKeyListener()">getHasKeyListener</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;short</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#getPriorityClass(com.db4o.ObjectContainer)">getPriorityClass</A></B>(com.db4o.ObjectContainer&nbsp;container)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Priority of the associated request.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../freenet/node/SendableGet.html" title="class in freenet.node">SendableGet</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#getRequestsForKey(freenet.keys.Key, byte[], com.db4o.ObjectContainer, freenet.client.async.ClientContext)">getRequestsForKey</A></B>(<A HREF="../../../freenet/keys/Key.html" title="class in freenet.keys">Key</A>&nbsp;key,
                  byte[]&nbsp;saltedKey,
                  com.db4o.ObjectContainer&nbsp;container,
                  <A HREF="../../../freenet/client/async/ClientContext.html" title="class in freenet.client.async">ClientContext</A>&nbsp;context)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Find the requests related to a specific key, used in retrying after cooldown.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#handleBlock(freenet.keys.Key, byte[], freenet.keys.KeyBlock, com.db4o.ObjectContainer, freenet.client.async.ClientContext)">handleBlock</A></B>(<A HREF="../../../freenet/keys/Key.html" title="class in freenet.keys">Key</A>&nbsp;key,
            byte[]&nbsp;saltedKey,
            <A HREF="../../../freenet/keys/KeyBlock.html" title="interface in freenet.keys">KeyBlock</A>&nbsp;block,
            com.db4o.ObjectContainer&nbsp;container,
            <A HREF="../../../freenet/client/async/ClientContext.html" title="class in freenet.client.async">ClientContext</A>&nbsp;context)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handle the found data, if we really want it.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#isEmpty()">isEmpty</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Has the request finished? If every key has been found, or enough keys have
 been found, return true so that the caller can remove it from the list.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#isSSK()">isSSK</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#killSegment(freenet.client.async.SplitFileFetcherSegment, com.db4o.ObjectContainer, freenet.client.async.ClientContext)">killSegment</A></B>(<A HREF="../../../freenet/client/async/SplitFileFetcherSegment.html" title="class in freenet.client.async">SplitFileFetcherSegment</A>&nbsp;segment,
            com.db4o.ObjectContainer&nbsp;container,
            <A HREF="../../../freenet/client/async/ClientContext.html" title="class in freenet.client.async">ClientContext</A>&nbsp;context)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#objectOnDeactivate(com.db4o.ObjectContainer)">objectOnDeactivate</A></B>(com.db4o.ObjectContainer&nbsp;container)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#onRemove()">onRemove</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Deactivate the request once it has been removed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#persistent()">persistent</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Is this related to a persistent request?</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#probablyWantKey(freenet.keys.Key, byte[])">probablyWantKey</A></B>(<A HREF="../../../freenet/keys/Key.html" title="class in freenet.keys">Key</A>&nbsp;key,
                byte[]&nbsp;saltedKey)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fast guess at whether we want a key or not.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../freenet/client/async/SplitFileFetcherKeyListener.html#writeFilters()">writeFilters</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="SplitFileFetcherKeyListener(freenet.client.async.SplitFileFetcher, int, java.io.File, java.io.File, int, int, byte[], int, int, int, boolean, boolean)"><!-- --></A><H3>
SplitFileFetcherKeyListener</H3>
<PRE>
public <B>SplitFileFetcherKeyListener</B>(<A HREF="../../../freenet/client/async/SplitFileFetcher.html" title="class in freenet.client.async">SplitFileFetcher</A>&nbsp;parent,
                                   int&nbsp;keyCount,
                                   <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</A>&nbsp;bloomFile,
                                   <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</A>&nbsp;altBloomFile,
                                   int&nbsp;mainBloomSizeBytes,
                                   int&nbsp;mainBloomK,
                                   byte[]&nbsp;localSalt,
                                   int&nbsp;segments,
                                   int&nbsp;segmentFilterSizeBytes,
                                   int&nbsp;segmentBloomK,
                                   boolean&nbsp;persistent,
                                   boolean&nbsp;newFilter)
                            throws <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</A></PRE>
<DL>
<DD>Caller must create bloomFile, but it may be empty.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>newFilter</CODE> - If true, the bloom file is empty, and the bloom filter
 should be created from scratch.
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</A></CODE></DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="countKeys()"><!-- --></A><H3>
countKeys</H3>
<PRE>
public long <B>countKeys</B>()</PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../freenet/client/async/KeyListener.html#countKeys()">countKeys</A></CODE> in interface <CODE><A HREF="../../../freenet/client/async/KeyListener.html" title="interface in freenet.client.async">KeyListener</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="probablyWantKey(freenet.keys.Key, byte[])"><!-- --></A><H3>
probablyWantKey</H3>
<PRE>
public boolean <B>probablyWantKey</B>(<A HREF="../../../freenet/keys/Key.html" title="class in freenet.keys">Key</A>&nbsp;key,
                               byte[]&nbsp;saltedKey)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../freenet/client/async/KeyListener.html#probablyWantKey(freenet.keys.Key, byte[])">KeyListener</A></CODE></B></DD>
<DD>Fast guess at whether we want a key or not. Usually implemented by a 
 bloom filter.
 LOCKING: Should avoid external locking if possible. Will be called
 within the CRSBase lock.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../freenet/client/async/KeyListener.html#probablyWantKey(freenet.keys.Key, byte[])">probablyWantKey</A></CODE> in interface <CODE><A HREF="../../../freenet/client/async/KeyListener.html" title="interface in freenet.client.async">KeyListener</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>True if we probably want the key. False if we definitely don't
 want it.</DL>
</DD>
</DL>
<HR>

<A NAME="definitelyWantKey(freenet.keys.Key, byte[], com.db4o.ObjectContainer, freenet.client.async.ClientContext)"><!-- --></A><H3>
definitelyWantKey</H3>
<PRE>
public short <B>definitelyWantKey</B>(<A HREF="../../../freenet/keys/Key.html" title="class in freenet.keys">Key</A>&nbsp;key,
                               byte[]&nbsp;saltedKey,
                               com.db4o.ObjectContainer&nbsp;container,
                               <A HREF="../../../freenet/client/async/ClientContext.html" title="class in freenet.client.async">ClientContext</A>&nbsp;context)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../freenet/client/async/KeyListener.html#definitelyWantKey(freenet.keys.Key, byte[], com.db4o.ObjectContainer, freenet.client.async.ClientContext)">KeyListener</A></CODE></B></DD>
<DD>Do we want the key? This is called by the ULPR code, because fetching the
 key will involve significant work. tripPendingKey() on the other hand
 will go straight to handleBlock().
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../freenet/client/async/KeyListener.html#definitelyWantKey(freenet.keys.Key, byte[], com.db4o.ObjectContainer, freenet.client.async.ClientContext)">definitelyWantKey</A></CODE> in interface <CODE><A HREF="../../../freenet/client/async/KeyListener.html" title="interface in freenet.client.async">KeyListener</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>-1 if we don't want the key, otherwise the priority of the request
 interested in the key.</DL>
</DD>
</DL>
<HR>

<A NAME="handleBlock(freenet.keys.Key, byte[], freenet.keys.KeyBlock, com.db4o.ObjectContainer, freenet.client.async.ClientContext)"><!-- --></A><H3>
handleBlock</H3>
<PRE>
public boolean <B>handleBlock</B>(<A HREF="../../../freenet/keys/Key.html" title="class in freenet.keys">Key</A>&nbsp;key,
                           byte[]&nbsp;saltedKey,
                           <A HREF="../../../freenet/keys/KeyBlock.html" title="interface in freenet.keys">KeyBlock</A>&nbsp;block,
                           com.db4o.ObjectContainer&nbsp;container,
                           <A HREF="../../../freenet/client/async/ClientContext.html" title="class in freenet.client.async">ClientContext</A>&nbsp;context)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../freenet/client/async/KeyListener.html#handleBlock(freenet.keys.Key, byte[], freenet.keys.KeyBlock, com.db4o.ObjectContainer, freenet.client.async.ClientContext)">KeyListener</A></CODE></B></DD>
<DD>Handle the found data, if we really want it.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../freenet/client/async/KeyListener.html#handleBlock(freenet.keys.Key, byte[], freenet.keys.KeyBlock, com.db4o.ObjectContainer, freenet.client.async.ClientContext)">handleBlock</A></CODE> in interface <CODE><A HREF="../../../freenet/client/async/KeyListener.html" title="interface in freenet.client.async">KeyListener</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getHasKeyListener()"><!-- --></A><H3>
getHasKeyListener</H3>
<PRE>
public <A HREF="../../../freenet/client/async/HasKeyListener.html" title="interface in freenet.client.async">HasKeyListener</A> <B>getHasKeyListener</B>()</PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../freenet/client/async/KeyListener.html#getHasKeyListener()">getHasKeyListener</A></CODE> in interface <CODE><A HREF="../../../freenet/client/async/KeyListener.html" title="interface in freenet.client.async">KeyListener</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>The parent HasKeyListener. This does mean it will be pinned in
 RAM, but it can be deactivated so it's not a big deal.
 LOCKING: Should avoid external locking if possible. Will be called
 within the CRSBase lock.</DL>
</DD>
</DL>
<HR>

<A NAME="getPriorityClass(com.db4o.ObjectContainer)"><!-- --></A><H3>
getPriorityClass</H3>
<PRE>
public short <B>getPriorityClass</B>(com.db4o.ObjectContainer&nbsp;container)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../freenet/client/async/KeyListener.html#getPriorityClass(com.db4o.ObjectContainer)">KeyListener</A></CODE></B></DD>
<DD>Priority of the associated request.
 LOCKING: Should avoid external locking if possible. Will be called
 within the CRSBase lock.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../freenet/client/async/KeyListener.html#getPriorityClass(com.db4o.ObjectContainer)">getPriorityClass</A></CODE> in interface <CODE><A HREF="../../../freenet/client/async/KeyListener.html" title="interface in freenet.client.async">KeyListener</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>container</CODE> - Database handle.</DL>
</DD>
</DL>
<HR>

<A NAME="getRequestsForKey(freenet.keys.Key, byte[], com.db4o.ObjectContainer, freenet.client.async.ClientContext)"><!-- --></A><H3>
getRequestsForKey</H3>
<PRE>
public <A HREF="../../../freenet/node/SendableGet.html" title="class in freenet.node">SendableGet</A>[] <B>getRequestsForKey</B>(<A HREF="../../../freenet/keys/Key.html" title="class in freenet.keys">Key</A>&nbsp;key,
                                       byte[]&nbsp;saltedKey,
                                       com.db4o.ObjectContainer&nbsp;container,
                                       <A HREF="../../../freenet/client/async/ClientContext.html" title="class in freenet.client.async">ClientContext</A>&nbsp;context)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../freenet/client/async/KeyListener.html#getRequestsForKey(freenet.keys.Key, byte[], com.db4o.ObjectContainer, freenet.client.async.ClientContext)">KeyListener</A></CODE></B></DD>
<DD>Find the requests related to a specific key, used in retrying after cooldown.
 Caller should call probablyWantKey() first.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../freenet/client/async/KeyListener.html#getRequestsForKey(freenet.keys.Key, byte[], com.db4o.ObjectContainer, freenet.client.async.ClientContext)">getRequestsForKey</A></CODE> in interface <CODE><A HREF="../../../freenet/client/async/KeyListener.html" title="interface in freenet.client.async">KeyListener</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="onRemove()"><!-- --></A><H3>
onRemove</H3>
<PRE>
public void <B>onRemove</B>()</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../freenet/client/async/KeyListener.html#onRemove()">KeyListener</A></CODE></B></DD>
<DD>Deactivate the request once it has been removed.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../freenet/client/async/KeyListener.html#onRemove()">onRemove</A></CODE> in interface <CODE><A HREF="../../../freenet/client/async/KeyListener.html" title="interface in freenet.client.async">KeyListener</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="persistent()"><!-- --></A><H3>
persistent</H3>
<PRE>
public boolean <B>persistent</B>()</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../freenet/client/async/KeyListener.html#persistent()">KeyListener</A></CODE></B></DD>
<DD>Is this related to a persistent request?
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../freenet/client/async/KeyListener.html#persistent()">persistent</A></CODE> in interface <CODE><A HREF="../../../freenet/client/async/KeyListener.html" title="interface in freenet.client.async">KeyListener</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="writeFilters()"><!-- --></A><H3>
writeFilters</H3>
<PRE>
public void <B>writeFilters</B>()
                  throws <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</A></PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="killSegment(freenet.client.async.SplitFileFetcherSegment, com.db4o.ObjectContainer, freenet.client.async.ClientContext)"><!-- --></A><H3>
killSegment</H3>
<PRE>
public int <B>killSegment</B>(<A HREF="../../../freenet/client/async/SplitFileFetcherSegment.html" title="class in freenet.client.async">SplitFileFetcherSegment</A>&nbsp;segment,
                       com.db4o.ObjectContainer&nbsp;container,
                       <A HREF="../../../freenet/client/async/ClientContext.html" title="class in freenet.client.async">ClientContext</A>&nbsp;context)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="isEmpty()"><!-- --></A><H3>
isEmpty</H3>
<PRE>
public boolean <B>isEmpty</B>()</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../freenet/client/async/KeyListener.html#isEmpty()">KeyListener</A></CODE></B></DD>
<DD>Has the request finished? If every key has been found, or enough keys have
 been found, return true so that the caller can remove it from the list.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../freenet/client/async/KeyListener.html#isEmpty()">isEmpty</A></CODE> in interface <CODE><A HREF="../../../freenet/client/async/KeyListener.html" title="interface in freenet.client.async">KeyListener</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="isSSK()"><!-- --></A><H3>
isSSK</H3>
<PRE>
public boolean <B>isSSK</B>()</PRE>
<DL>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../freenet/client/async/KeyListener.html#isSSK()">isSSK</A></CODE> in interface <CODE><A HREF="../../../freenet/client/async/KeyListener.html" title="interface in freenet.client.async">KeyListener</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="objectOnDeactivate(com.db4o.ObjectContainer)"><!-- --></A><H3>
objectOnDeactivate</H3>
<PRE>
public void <B>objectOnDeactivate</B>(com.db4o.ObjectContainer&nbsp;container)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../freenet/client/async/SplitFileFetcher.html" title="class in freenet.client.async"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../freenet/client/async/SplitFileFetcherSegment.html" title="class in freenet.client.async"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?freenet/client/async/SplitFileFetcherKeyListener.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SplitFileFetcherKeyListener.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
